```{r, message=FALSE, echo=FALSE, results='hide', warning=FALSE}

# Daten müssen zuerst nach "week" und "condition" zusammengefasst werden
df <- nova %>%
    group_by(week, condit) %>%  
    summarise(tot_sold = n()) # zählt alle Beobachtungen gemäss dem group_by zusammen

# Sind die Varianzen homogen?
leveneTest(df$tot_sold, df$condit)

```

Der t-Test für unabhängige Gruppen setzt Varianzhomogenität voraus. Liegt Varianzheterogenität vor (also unterschiedliche Varianzen), so müssen unter anderem die Freiheitsgerade des t-Wertes angepasst werden. Ob die Varianzen nun homogen ("gleich") sind, lässt sich mit dem Levene-Test auf Varianzhomogenität prüfen. Dieser Test ist eine Variante des F-Tests.

Der Levene-Test verwendet die Nullhypothese, dass sich die beiden Varianzen nicht unterscheiden. Daher bedeutet ein nicht signifikantes Ergebnis, dass sich die Varianzen nicht unterscheiden und also Varianzhomogenität vorliegt. Ist der Test signifikant, so wird von Varianzheterogenität ausgegangen (Quelle: www.uzh.ch).

```{r, message=FALSE, echo=FALSE, results='hide', warning=FALSE}

t.test(df[df$condit == "Basis", ]$tot_sold, df[df$condit == "Intervention", ]$tot_sold, var.equal = F) # siehe ungerichtete Hypothese

# Visualisiere die Ergebnisse
ggplot(df, aes(x = condit, y= tot_sold)) + 
    geom_boxplot(fill = "lightgrey") + 
    labs(x="Bedingungen", y="Anzahl verkaufte Gerichte") + theme_apa(x.font.size = 20, y.font.size = 20) +  theme(axis.text = element_text(size = 20))
```

In den Basiswochen werden mehr Gerichte als in den Interventionsowchen verkauft. Die Verkaufszahlen zwischen den Bedigungen (Basis oder Intervention) unterscheiden sich nicht signifikant (*t*(2.99) = 2.06, *p* = 0.13).