---
title: "Übungen Statistik"
author: "Gian-Andrea Egeler"
date: "18. September 2018"
output: html_document
---


### Erläuterungen zum Datensatz

Der Datensatz beinhaltet knapp 1100 Einträge mit 18 Variablen. Die Daten stammen aus dem Kassensystem des Catering-Unternehmen und stellen eine repräsentative Stichprobe des originalen Datensatzes dar.

Folgende Variablen sind im Datensatz:


|   Name der Variable	|   Beschreibung der Variable	|   
|---	|---	|
|   "transaction_id" |  Durch das Kassensystem generierte Identifikationsnummer	| 
|   "date"	|   Datum	|
|  "week" | Kalenderwoche |
|  "year" | Kalenderjahr  |
|  "meal_name" | Beschreibung der angebotenen Mahlzeit  |
|  "article_description" | Beschreibung der Menü-Linie (Favorite, Hot and Cold Buffet, Kitchen, Locals<sup>1</sup>, World)  |
|  "label_content" | Beschreibung des Menü-Inhalts (Fleisch<sup>2</sup>, Hot and Cold, Vegan<sup>3</sup>, Vegetarisch<sup>4</sup>)  |
|  "condit" | Beschreibung der Experimentalwochen (Basis- und Interventionswochen)  |
|  "card_num" | anonymisierte Kartennummer  |
|  "gender" | Geschlecht (F,M)  |
|  "member" | Hochschulzugehörigkeit (Studierdene, Mitarbeitende, "Lernende", "Spezialkarten")  |
|  "age" |  Alter in Jahren |
|  "price_article" |  Preis des gekauften Artikels |
|  "total_amount_pay" | Total bezahlter Betrag  |
|  "pay_description" | Bezahlungsart (Cash oder Badge (Debit))  |
|  "shop_description" | Ort der Mensa (Grüental oder Vista)  |
|  "tot_ubp" | Umweltbelastungspunkte pro Gericht  |
|  "buffet_animal" | Anzahl fleischhaltiger Produkte auf dem Hot and Cold Buffet |

--------

**Bemerkungen:**

1. Locals (Local Favorite, Local Kitchen, Local World) sind nebst den drei "normalen Menü-Linien" zusätzlich angebotene Gerichte
2. hier werden Gerichte mit Fisch & Geflügel als Fleisch zusammengefasst.
3. Vegane Menüs sind ausschliesslich pflanzliche Gerichte. Im Exeriment wurde zwischen pflanzlich substituierten und authentisch, eigenständige Gerichte unterschieden
4. Vegetarische Menüs sind ovo-lakto-vegetarische Gerichte.

<br><br>

### Aufgabe 1: Assoziationstest

Führen Sie einen beliebigen $\chi^2$-Test mit dem Datensatz novanimal.csv durch und interpretieren Sie die Ergebnisse. Z. B. Unterscheiden sich die Geschlechter bezüglich ihrer Menü-Wahl? Gibt es Unterschiede in der Hochschulzugehörigkeit und den Geschlechtern?


### Musterlösung Aufgabe 1

```{r, message=FALSE, echo=FALSE, results='hide', warning=FALSE}

library(readr)
library(dplyr)
library(car)
library(gmodels)
library(ggfortify)
library(pander)
library(stargazer)

nova <- read_delim("/home/egel/Unterrichtsunterlagen_HS18/13_Statistik1/data/novanimal.csv", delim = ";")

```

```{r, message=FALSE, echo=FALSE, results='hide', warning=FALSE}
chisq.test(nova$gender, nova$label_content)
CrossTable(nova$gender, nova$label_content, chisq = T) # Alternative zu chisq.test

chisq.test(nova$member, nova$gender)
CrossTable(nova$member, nova$gender, chisq = T)

```



### Aufgabe 2: t-Test

Führen sie einen t-Test durch. Werden in den Fleischwoche (Basiswochen) mehr Gerichte verkauft als in den vegetarischen Wochen (Interventionswochen)?
* Welche Form von t-Test müssen Sie anwenden? einseitig/zweiseitig? gepaart/ungepaart?
* Führen Sie den t-Test durch und interpretieren Sie die Ergebnisse
* Visualisieren mit einem Boxplot


### Musterlösung Aufgabe 2
```{r, message=FALSE, echo=FALSE, results='hide', warning=FALSE}
# Daten müssen zuerst nach Kalenderwochen und Kondition zusammengefasst werden
df <- nova %>%
    group_by(condit, week) %>% # 
    summarise(tot_sold = n())

leveneTest(df$tot_sold, df$condit)

```

Der t-Test für unabhängige Gruppen setzt Varianzhomogenität voraus. Liegt Varianzheterogenität vor (also unterschiedliche Varianzen), so müssen unter anderem die Freiheitsgerade des t-Wertes angepasst werden. Ob die Varianzen nun homogen ("gleich") sind, lässt sich mit dem Levene-Test auf Varianzhomogenität prüfen. Dieser Test ist eine Variante des F-Tests.

Der Levene-Test verwendet die Nullhypothese, dass sich die beiden Varianzen nicht unterscheiden. Daher bedeutet ein nicht signifikantes Ergebnis, dass sich die Varianzen nicht unterscheiden und also Varianzhomogenität vorliegt. Ist der Test signifikant, so wird von Varianzheterogenität ausgegangen (Quelle: www.uzh.ch).

```{r, message=FALSE, echo=FALSE, results='hide', warning=FALSE}

t.test(df[df$condit == "Basis", ]$tot_sold, df[df$condit == "Intervention", ]$tot_sold, var.equal = F, alternative = "less") # siehe gerichtete Hypothese

# boxplot

ggplot(df, aes(x = condit, y= tot_sold)) + 
    geom_boxplot(fill = "lightgrey") + 
    labs(x="Bedingungen", y="Anzahl verkaufte Gerichte")
```
