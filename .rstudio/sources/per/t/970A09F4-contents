
```{r, include=FALSE, purl=F}

knitr::opts_chunk$set(echo = TRUE,include = T, results = "hide",collapse=TRUE)
```

## Demoskript

 __t-test als ANOVA__ 

```{r}
a<-c(20,19,25,10,8,15,13,18,11,14)
b<-c(12,15,16,7,8,10,12,11,13,10)

blume<-data.frame(cultivar=c(rep("a",10),rep("b",10)),size=c(a,b))

par(mfrow=c(1,1))
boxplot (data=blume, size~cultivar, xlab="Sorte", ylab="Bl�tengr�sse [cm�]")

t.test(size~cultivar, blume, var.equal=T)

aov(size~cultivar,data=blume)
summary(aov(size~cultivar,data=blume))
summary.lm(aov(size~cultivar,data=blume))
```


__Echte ANOVA__

```{r}
c<-c(30,19,31,23,18,25,26,24,17,20)

blume2<-data.frame(cultivar=c(rep("a",10),rep("b",10),rep("c",10)),size=c(a,b,c))

summary(blume2)             
head(blume2)

par(mfrow=c(1,1))
boxplot (data=blume2, size~cultivar, xlab="Sorte", ylab="Bl�tengr�sse [cm�]")

aov(size~cultivar,data=blume2)
summary(aov(size~cultivar,data=blume2))
summary.lm(aov(size~cultivar,data=blume2))

lm(size~cultivar,data=blume2)
summary(lm(size~cultivar,data=blume2))
```


__Tukeys Posthoc-Test__

```{r}
library(multcomp)
summary(glht(aov(size~cultivar, data=blume2),linfct=mcp(cultivar ="Tukey")))
```


__Beispiel Posthoc-Labels in Plot__

```{r}
anova <- aov(Sepal.Width ~ Species, data=iris)
letters <- cld(glht(anova, linfct=mcp(Species="Tukey")))
boxplot(Sepal.Width ~ Species, data=iris)
mtext(letters$mcletters$Letters, at=1:3)
```


__Classical tests for model assumptions (NOT RECOMMENDED!!!)__

```{r}
attach(blume2)
shapiro.test(size[cultivar == "a"])

var.test(size[cultivar == "a"],size[cultivar == "b"])

library(car)
leveneTest(size[cultivar == "a"],size[cultivar == "b"],center=mean)

wilcox.test(size[cultivar == "a"],size[cultivar == "b"])

detach(blume2)
```


__Non-parametric alternatives if assumptions of ANOVA are strongly violated__

__Zum Vergleich normale ANOVA noch mal__

```{r}
summary(aov(size~cultivar,data=blume2))
```

__For strong deviation from normality, but similar variances__

__Kruskal-Wallis-Test__

```{r}
kruskal.test(data=blume2, size~cultivar)
library(FSA)
dunnTest(data=blume2, size~cultivar, method="bh") #korrigierte p-Werte nach Bejamini-Hochberg
```

__For strong heteroscedasticity, but relatively normal/symmetric distributions of residuals: We__

__Welch-Test__

```{r}
oneway.test(data=blume2, size~cultivar, var.equal=F)
```

__2-way ANOVA__

```{r}

d<-c(10,12,11,13,10,25,12,30,26,13)
e<-c(15,13,18,11,14,25,39,38,28,24)
f<-c(10,12,11,13,10,9,2,4,7,13)

blume3<-data.frame(cultivar=c(rep("a",20),rep("b",20),rep("c",20)),
                   house=c(rep(c(rep("yes",10),rep("no",10)),3)),size=c(a,b,c,d,e,f))
blume3

boxplot(size~cultivar+house,data=blume3)

summary(aov(size~cultivar+house,data=blume3))
summary(aov(size~cultivar*house,data=blume3))

summary.lm(aov(size~cultivar+house,data=blume3))


interaction.plot(blume3$cultivar,blume3$house,blume3$size)

anova(lm(blume3$size~blume3$cultivar*blume3$house),lm(blume3$size~blume3$cultivar+blume3$house))
anova(lm(blume3$size~blume3$house),lm(blume3$size~blume3$cultivar*blume3$house))
```


__Korrelationen__

```{r}
library(car)

blume<-data.frame(a,b)
scatterplot(a~b,blume)
```
