```{r, include=F, purl = F}
# knitr::opts_knit$set(root.dir = "14_Statistik2") 
```


```{r, message=F, include=F}
library(tidyverse)
```


#### Beispiel 1: Pearson’s product moment correlation

[Script als Download](14_Statistik2/RFiles/Demo_01_Korr_Reg_Beispiel1.R)

Aus @logan2010 [S. 184]: Script an Tools/Packages des Moduls Research Methods angepasst

Sokal and Rohlf (1997) present an unpublished data set (L. Miller) in which the correlation between *gill weight* and *body weight* of the crab (*Pachygrapsus crassipes*) is investigated.


##### Step 1
Import the crabs data set [crabs.csv](14_Statistik2/data/crabs.csv)

```{r, message = F}
crabs <- read_csv("14_Statistik2/data/crabs.csv")
```

##### Step 2
Assess linearity and bivariate normality using a scatterplot with marginal boxplots

```{r,fig.cap="Conclusions - data not obviously nonlinear and no evidence of nonnormality (boxplots not asymmetrical) [@logan2010]"}
library(ggExtra) # damit wir boxplots um den Scatterplot zeichnen können


p <- ggplot(crabs, aes(BODYWT, GILLWT)) +
  geom_point() +
  geom_smooth(method = "loess")


ggMarginal(p, type = "boxplot",size = 15)

```


##### Step 3

Calculate the Pearson’s correlation coefficient and test $H_0 : \rho = 0$ (that the population correlation coefficient equals zero).

```{r}
cor.test(~GILLWT + BODYWT, crabs)

```

Conclusions - reject $H_0$ that population correlation coefficient equals zero, there was a strong positive correlation between crab weight and gill weight ($r = 0.865$, $t_{10} = 5.45$, $P< 0.001$).


